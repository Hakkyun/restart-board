<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>게시판</title>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
	<link rel="stylesheet" th:href="@{/css/common.css}">
</head>
<body>
	<div th:replace="~{fragments/header :: headerFragment}"></div>
	<div class="container mt-4">
	    <h1 class="mb-4"->📋 게시판</h1>
	    
		<!-- 작성 버튼 -->
		<div class="mb-3 text-end">
			<a class="btn btn-primary" th:href="@{/board/write}" sec:authorize="isAuthenticated()">글쓰기</a>
			<button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#loginRequiredModal" sec:authorize="!isAuthenticated()">글쓰기</button>
		</div>
		
		<!-- 게시글 목록 테이블 -->
		<!-- <p th:if="${#lists.isEmpty(posts)}">게시글이 없습니다.</p> -->
		<!-- th:if="${not #lists.isEmpty(posts)" -->
		<table class="table table-striped" border="1">
			<thead>
				<tr>
					<th>번호</th>
					<th>제목</th>
					<th>작성자</th>
					<th>내용</th>
					<th>작성시간</th>
				</tr>
			</thead>
			<tbody>
				<tr th:each="post : ${posts}">
					<td th:text="${post.brdId}" class="align-center"></td>
					<td th:text="${post.brdTitle}"></td>
					<td th:text="${post.brdWriter}" class="align-center"></td>
					<!-- 이렇게 쓸 경우 substring 범위보다 String의 길이가 짧을 경우 StringIndeOutOfBoundsExcepion 발생 -->
					<!-- <td th:text="${#strings.substring(post.brdContent, 0, 1) + '...'}"></td> -->
					<td th:text="${#strings.length(post.brdContent) > 18 ? #strings.substring(post.brdContent, 0, 18) + '...' : post.brdContent}"></td>
					<td th:text="${#temporals.format(post.brdRegTime, 'yyyy-MM-dd HH:mm:ss')}" class="align-center"></td>	
				</tr>
			</tbody>
		</table>
	</div>

	<!-- 모달 -->
	<div class="modal fade" id="loginRequiredModal" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
	  <div class="modal-dialog">
	    <div class="modal-content">
	      <div class="modal-header">
	        <h5 class="modal-title">로그인이 필요합니다</h5>
	        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
	      </div>
	      <div class="modal-body">
	        글쓰기는 회원 전용 기능입니다. 로그인 후 이용해주세요.
	      </div>
	      <div class="modal-footer">
	        <!-- 로그인으로 이동 (로그인 후 글쓰기 화면으로 돌아오고 싶다면 redirect 파라미터 활용) -->
	        <a class="btn btn-primary" th:href="@{user/login}" id="goLoginBtn">로그인</a>
	        <button class="btn btn-outline-secondary" data-bs-dismiss="modal">닫기</button>
	      </div>
	    </div>
	  </div>
	</div>	
	
	<!-- <script th:src="@{/js/main.js}"></script> -->
	<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js" integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js" integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous"></script>
</body>
</html>
